"0",""
"0","utopia_characters <- read.csv(""utopia_entities_clean.csv"")[c(-1)] %>%"
"0","  filter(kind==""person"")"
"0",""
"0","utopia_total <- read.csv(""utopia_entities_sentiments_clean.csv"")"
"0",""
"0",""
"0","authors <- utopia_characters %>%"
"0","  distinct(author)"
"0",""
"0","vertices <- c()"
"0","edgeList <- c()"
"0",""
"0",""
"0",""
"0","for (i in seq_along(authors[,1])) {"
"0","  author <- authors[i,1]"
"0","  author_characters <- filter(utopia_total, author==authors[i,]) "
"0","  "
"0",""
"0","  vertices <- append(vertices, as.vector(author_characters$entity))"
"0","  "
"0","  for (j in seq_along(author_characters)) {"
"0","    edgeList <- append(edgeList, c(author, author_characters[j, 4]))"
"0","    "
"0","    if (is.na(edgeList[length(edgeList)])) {"
"0","      edgeList <- head(edgeList, -2)"
"0","    }"
"0","    else {"
"0","      if(author_characters[j, 7] == ""m"")"
"0","        colors <- append(colors, c(""#AAAAAA"", ""#0000FF""))"
"0","      else"
"0","        colors <- append(colors, c(""#AAAAAA"", ""#FFB6C1""))"
"0","    }"
"0","  }"
"0","  "
"0","}"
"0",""
"0",""
"0","edgeList <- edgeList[!is.na(edgeList)]"
"0","make_graph(edges=edgeList)"
"1","IGRAPH 4316ead DN-- 26 23 -- "
"1",""
"1","
"
"1","+ attr: name (v/c)"
"1","
"
"1","+ edges from 4316ead (vertex names):
"
"1",""
"1",""
"1"," [1] Rokheya Shekhawat Hossein->Barnita Bagchi Rokheya Shekhawat Hossein->Queen         "
"1","
"
"1"," [3] Rokheya Shekhawat Hossein->Sister Sara    Gilman, Charlotte Perkins->Alma          "
"1","
"
"1"," [5] Gilman, Charlotte Perkins->Ellador        Gilman, Charlotte Perkins->Jeff Margrave "
"1","
"
"1"," [7] Gilman, Charlotte Perkins->Mike           Gilman, Charlotte Perkins->Nicholson     "
"1","
"
"1"," [9] Gilman, Charlotte Perkins->Queen          Gilman, Charlotte Perkins->Somel         "
"1","
"
"1","[11] More, Thomas, Saint      ->John More      More, Thomas, Saint      ->Morton        "
"1","
"
"1","[13] More, Thomas, Saint      ->Peter Giles    More, Thomas, Saint      ->Raphael       "
"1","
"
"1","[15] More, Thomas, Saint      ->Solomon        More, Thomas, Saint      ->Thomas        "
"1","
"
"1",""
"1",""
"1",""
"1","+ ... omitted several edges
"
"1",""
"0","newgraph <- graph(edgeList, directed=FALSE)"
"0",""
"0","colors <- c()"
"0","agg_sentiment <- c()"
"0","for (i in seq_along(V(newgraph)$name)) {"
"0","  character_gender <- utopia_total %>%"
"0","    filter(entity == V(newgraph)$name[i])"
"0","  if (length(character_gender[, 1]) == 0)"
"0","    colors <- append(colors, ""#000000"")"
"0","  else if(character_gender[1, ""gender""] == ""m"")"
"0","    colors <- append(colors, ""#0000FF"")"
"0","  else "
"0","    colors <- append(colors, ""#D90166"")"
"0","  "
"0","  "
"0","  if (length(character_gender[, 1]) == 0)"
"0","    agg_sentiment <- append(agg_sentiment, ""#AAAAAA"")"
"0","  else if(character_gender[1, ""total""] < 0)"
"0","    agg_sentiment <- append(agg_sentiment, ""#FFFCBB"")"
"0","  else "
"0","    agg_sentiment <- append(agg_sentiment, ""#FF7F7F"")"
"0","  "
"0","}"
